<!DOCTYPE html>
<html>
<body>
    <h2>User Management</h2>
    <div id="signup">
        <h3>Sign Up</h3>
        <input id="su-userid" placeholder="User ID">
        <input id="su-password" type="password" placeholder="Password">
        <input id="su-name" placeholder="Name">
        <input id="su-email" placeholder="Email">
        <button onclick="doSignup()">Sign Up</button>
    </div>
    <div id="login">
        <h3>Login</h3>
        <input id="login-userid" placeholder="User ID">
        <input id="login-password" type="password" placeholder="Password">
        <button onclick="doLogin()">Login</button>
    </div>
    <div id="user-info" style="display:none;">
        <h3>User Information</h3>
        <p id="user-id"></p>
        <p id="user-name"></p>
        <p id="user-email"></p>
    </div>
    <script src="user.js"></script>
    <script>
        Module.onRuntimeInitialized = function() {
            window.signup = Module.cwrap('signup', 'number', ['string', 'string', 'string', 'string']);
            window.login = Module.cwrap('login', 'string', ['string', 'string']);
            window.free_string = Module.cwrap('free_string', null, ['number']);
        }

        function doSignup() {
            var result = signup(
                document.getElementById('su-userid').value,
                document.getElementById('su-password').value,
                document.getElementById('su-name').value,
                document.getElementById('su-email').value
            );
            alert(result ? "Signup successful" : "Signup failed");
        }

        function doLogin() {
            var result = login(
                document.getElementById('login-userid').value,
                document.getElementById('login-password').value
            );
            if (result) {
                var userInfo = JSON.parse(result);
                document.getElementById('user-id').textContent = "User ID: " + userInfo.user_id;
                document.getElementById('user-name').textContent = "Name: " + userInfo.name;
                document.getElementById('user-email').textContent = "Email: " + userInfo.email;
                document.getElementById('user-info').style.display = 'block';
                free_string(result);
            } else {
                alert("Login failed");
                document.getElementById('user-info').style.display = 'none';
            }
        }
    </script>
</body>
</html>
